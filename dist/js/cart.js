"use strict";function proPriceSum(){console.log("刷新单品总价"),$(".pro-price-sum").each(function(){var e=parseInt($(".pro-price").eq($(this).parent().parent().index()).text())*parseInt($(".goods-num").eq($(this).parent().parent().index()).val());$(this).text(e)})}function delGoods(e,o){console.log("删除物品"),1==o?$(".item-table").eq($(e).parent().parent().index()).remove():2==o&&$(".item-table").eq($(e).parent().parent().parent().index()).remove()}function delBtns(){var e=this;$(".del-btn").click(function(){delGoods(e,1)})}function upAndDown(){$(".item-table .col-num .down").click(function(){var e=$(this).siblings(".goods-num").val();1==e?delGoods(this,2):($(this).siblings(".goods-num").val(e-1),proPriceSum()),proNumInit()}),$(".item-table .col-num .up").click(function(){var e=$(this).siblings(".goods-num").val();$(this).siblings(".goods-num").val(e-0+1),proPriceSum(),proNumInit()})}function iconYesToogle(){$(".icon-yes").off("mouseenter"),$(".icon-yes").not(".active").mouseenter(function(){$(this).css("color","#424242")}),$(".icon-yes").not(".active").mouseleave(function(){$(this).css("color","#fff")})}function iconYesBind(){$(".icon-yes").click(function(){1==$(this).hasClass("all")?(console.log($(".icon-yes").length),console.log($(".icon-yes.active").length),console.log($(".icon-yes").length-1>$(".icon-yes.active").length),$(".icon-yes").length-1>$(".icon-yes.active").length?($(".icon-yes").addClass("active"),$(".pro-price-sum").addClass("active"),$(".goods-num").addClass("active")):($(".icon-yes").removeClass("active"),$(".pro-price-sum").removeClass("active"),$(".goods-num").removeClass("active"))):($(this).toggleClass("active"),$(".pro-price-sum").eq($(this).parent().parent().index()).toggleClass("active"),$(".goods-num").eq($(this).parent().parent().index()).toggleClass("active"),$(".icon-yes").length-1==$(".icon-yes.active").length&&$(".icon-yes.all").toggleClass("active")),iconYesToogle(),proNumInit()})}function proNumInit(){var e=0,o=0,i=0;console.log("刷新结算信息"),$(".goods-num").each(function(){e+=$(this).val()-0}),$(".goods-num.active").each(function(){o+=$(this).val()-0}),$(".pro-num-total").text(e),$(".pro-num").text(o),$(".pro-price-sum.active").each(function(){i+=parseInt($(this).text())}),$(".pro-price-total").text(i)}$(document).ready(function(){console.log("页面加载完毕"),$.get("../interface/showlist.php",function(e){var o=JSON.parse(e);0==o.code?alert("购物车里面空空的"):($(".main .item-box .item-table").remove(),$(o.data).each(function(){$tableStr='<div class="item-table"><div class="col-check"><i class="iconfont icon-yes"></i> </div><div class="col-img"><img src="'+this.product_img+'" alt=""></div><div class="col-name">'+this.product_name+'</div><div class="col-price"><span class="pro-price">'+this.product_price+'</span> 元</div><div class="col-num"><div class="num-counter"><div class="down">-</div><input type="text" class="goods-num" value="'+this.product_num+'"><div class="up">+</div></div></div><div class="col-total"><span class="pro-price-sum">0</span> 元</div><div class="col-action"><i class="del-btn">×</i></div></div>',$(".main .item-box").append($tableStr)}),proPriceSum(),upAndDown(),iconYesToogle(),iconYesBind(),delBtns(),proNumInit())})}),$(".goods-num").on("blur",function(){proPriceSum(),proNumInit()}),delBtns(),upAndDown(),iconYesToogle(),proNumInit(),$(".btn-primary").click(function(){alert("交易成功,共计购买"+$(".pro-num").text()+"件商品,已付费"+$(".pro-price-total").text()+"元")});